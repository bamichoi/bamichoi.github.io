---
title: JavaScript Deep Dive. 17. 생성자 함수에 의한 객체 생성
categories: [javascript]
comments: true
---

# 17. 생성자 함수에 의한 객체 생성

## Object 생성자 함수
  
- new 연산자와 함께 Object 생성자 함수를 호출하면 객체를 생성하여 반환한다. 빈 객체를 생성한 후 프로퍼티 또는 메소드를 추가할 수 있다.
  
- 생성자 함수 constructor 는 new 연산자와 함께 호출하여 인스턴스를 생성하는 함수를 말한다.
  
## 생성자 함수

- 객체 리터럴에 의한 객체 생성은 직관적이고 간편하지만, 동일한 프로퍼티를 갖는 객체를 여러개 생성해야할 경우 비효율적이다.
  이 경우, 생성자 함수를 사용하여 프로퍼티 구조가 동일한 객체 여러 개를 간편하게 생성할 수 있다.
  
- this는 자기 참조 변수 self-refrencing varable 이다. this가 가리키는 값(this 바인딩)은 함수 호출 방식에 따라 동적으로 결정된다.
  일반 함수로서 호출 - 전역 객체  
  메소드로서 호출 - 메소드를 호출한 객체(마침표 앞의 객체)  
  생성자 함수로서 호출 - 생성자 함수가 생성할 인스턴스  
  
- 생성자 함수는 객체(인스턴스)를 생성하는 함수다. 자바스크립트에서는 일반 함수와 동일한 방법으로 생성자 함수를 정의하고, new 연산자와 함께 호출할 때에만 생성자 함수로 동작한다. 만약 new 연산자와 함께 호출하지 않으면 일반 함수로 동작한다.

## 생성자 함수의 인스턴스 생성 과정

1. 인스턴스 생성과 this 바인딩
  암묵적으로 빈 객체가 생성된다. 인스턴스는 this에 바인딩 된다. 이 처리는 함수 몸체의 코드가 한줄씩 실행되는 런타임 이전에 실행된다.
  
2. 인스턴스 초기화
  생성자 함수에 기술되어 있는 코드가 한 줄씩 실행되어 this에 바인딩 되어 있는 인스턴스에 프로퍼티나 메소드를 추가하고, 그 값들을 할당하여 초기화 한다.
  
3. 인스턴스 반환
  생성자 함 수 내부의 모든 처리가 끝나면 완성된 인스턴스가 암묵적으로 반환된다.
  
- 만약 this가 아닌 다른 객체를 명시적으로 반환하면 return 문에 명시한 객체가 반환된다. 하지만 원시 값을 반환한다면 원시 값 반환은 무시되고 암묵적으로 this가 반환된다.
    
  
## 내부 메소드 [[Call]] 과 [[Construct]]
  
- 함수 객체는 일반 객체가 가지고 있는 내부 슬롯과 내부 메소드를 포함해 함수로서 동작하기 위한 [[Environment]], [[FormalParameters]] 등의 내부 슬롯과 [[Call]]. [[Construct]] 같은 내부 메소드를 추가로 가진다.
  
- 함수가 일반 함수로 호출되면 함수 객체의 내부 메소드 [[Call]]이 호출되고, new 연산자와 함께 생성자 함수로 호출되면 내부 메소드 [[Cosntruct]]가 호출된다.
  
- 내부 메소드 [[Call]]을 갖는 함수 객체를 callabe 이라고 하며 내부 메소드 [[Construct]]를 갖는 함수 객체를 constructor, [[Construct]]를 갖지 앚는 함수 객체를 non- construct라고 한다.  

- 즉, 모든 함수 객체는 반드시 callable 이면서, constructor이거나 혹은 non-constructor이다.
  
  
 ## constructor와 non-constructor의 구분

- constroctor : 함수 선언문, 함수 표현식, 클래스, 프로퍼티 값으로 사용된 함수
- non constructor : 메소드(ES6의 메소드 축약표현), 화살표 함수
  
- non-constructor인 함수 객체를 생성자 함수로서 호출하면 에러가 발생한다.

   
## new 연산자 

- 일반 함수와 생성자 함수에 특별한 형식적 차이는 없다. new 연산자와 호출하면 생성자 함수로 동작고, new 연산자 없이 호출되면 일반 함수로 동작한다.
  
- 구분을 위해 생성자 함수는 일반적으로 첫 문자를 대문자로 사용하는 파스칼 케이스로 명명된다.


## new.target

- new.target은 생성자 함수가 new 연산자 없이 호출되는 것을 방지한다.
   
- 함수 내부에서 new.target 연산자를 사용하면 함수가  new 연산자와 함께 생성자 함수로서 호출되었는지 확인할 수 있다.
  new 연산자와 함께 생성자 함수로서 호출되면 new.target은 함수 자신을 가리키고, 일반 함수로 호출되었을경우 new.target은 undefined이다.

- 대부분의 빌트인 생성자 함수(Object, String, Number, Boolean, Function, Array, Date, RegExp, Promise 등)들은 new 연산자와 함께 호출되었는지를 확인후 적절한 값을 반환한다.
  예를 들어 Object와 Function 생성자 함수는 new 연산자 없이 호출해도 생성자 함수로서 호출한 것처럼 작동한다.
  단 String, Number, Boolean 생성자 함수는 new 연산자와 함께 호출하면 String, Number, Boolean 객체를 생성하여 반환하지만  new 연산자 없이 호출하면 문자열, 숫자, 불리언 값을 반환한다. 이를 통해 데이터 타입을 변환하기도 한다.
  
  
  